{# q_user.html #}

{% extends "questionnaire/q_base.html" %}

{% load static %}
{% load q_tags %}


{% block title %}
    {{ block.super }}
    User
{% endblock %} {# /title #}

{% block scripts %}
    {{ block.super }}
        <script language="JavaScript" type="text/javascript" src="{% static 'djangular/js/django-angular.js' %}"></script>
        <script language="javascript" type="text/javascript" src="{% static 'questionnaire/js/q_ng_user.js' %}"></script>
{% endblock %} {# /scripts #}

{% block content %}


<div ng-app="q_user">
    <div ng-controller="UserController as user_controller">

{# wrapping everything in bootstrap grids to help w/ placement #}

        <div class="container-fluid">
            <div class="col-md-12">

        <div class="title row">
            CIM Questionnaire User
        </div>

        <div class="documentation row">
            <div class="col-md-12">
                Information about the user: <span class="lead">{{ user }}</span>.
            </div>
            {% if request.user == user %}
                <div class="col-md-12">
                    <a class="btn btn-sm btn-primary" href="{{ request.path }}password?next={{ request.path }}">Reset Password</a>
                </div>
            {% endif %}
        </div> <!-- /.documentation -->

    <div class="row">

        <div class="col-md-6">

            <form class="form-horizontal" method="POST" action="">

                {% csrf_token %}

                {% if form.non_field_errors %}
                    <div class="alert alert-danger" role="alert">
                        {{ form.non_field_errors }}
                    </div>
                {% endif %} {# /form.non_field_errors #}

                {% for field in form %}
                    <div class="form-group {% cycle 'odd' 'even' %}">
                        <span class="col-sm-2">
                            {% with help_text=field.help_text %}
                                {% if help_text %}
                                    <span class="col-sm-1">
                                        {% include 'questionnaire/_q_help.html' %}
                                    </span>
                                    <span class="col-sm-8">
                                        {{ field.label }}:
                                    </span>
                                {% else %}
                                    {{ field.label }}:
                                {% endif %} {# /help_text #}
                            {% endwith %} {# /help_text #}
                        </span>
                        <div class="col-sm-8">
                           {{ field }}
                           {% if field.errors %}
                               {% include 'questionnaire/_q_error.html' %}
                           {% endif %} {# / field.errors #}
                        </div>
                    </div> <!-- /.form-group -->
                {% endfor %} {# /field #}

                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-8">
                        <button type="submit" class="btn btn-primary">submit</button>
                    </div>
                </div>

            </form> <!-- /.form-horizontal -->
        </div> <!-- /.col-md-6 -->

        <div class="col-md-offset-1 col-md-5">

            <div class="list-group small">
                <span class="list-group-item active">Project Affiliations:&nbsp;</span>
                {% if projects.count %}
                    {% for project in projects %}
                        <li class="list-group-item">
                            <span class="badge">
                                {% if user|is_admin_of:project %}
                                    admin
                                {% elif user|is_user_of:project %}
                                    user
                                {% else %}
                                    member
                                {% endif %}
                            </span>
                            <a href="/{{ project.name }}">
                                {{ project.title }}
                            </a>
                        </li>
                    {% endfor %} {# /project #}
                {% else %}
                    <li class="list-group-item">
                        <span class="documentation text-muted">No project affiliations found.</span>
                    </li>
                {% endif %}

            </div> <!-- /.list-group -->

        </div> <!-- /.col-md-6 -->

    </div> <!-- /.row -->

                </div>
            </div>
        </div>
    </div>


{% endblock %} {# /content #}